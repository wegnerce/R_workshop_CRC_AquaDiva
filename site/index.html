<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="None">
  
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>I. Getting started - R from a learners perspective - Data visualization</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="css/theme.css" type="text/css" />
  <link rel="stylesheet" href="css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "I. Getting started";
    var mkdocs_page_input_path = "index.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="index.html" class="icon icon-home"> R from a learners perspective - Data visualization</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1 current">
		
    <a class="current" href="index.html">I. Getting started</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#data-visualization-and-exploration">Data visualization and exploration</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#synopsis">Synopsis</a></li>
        
            <li><a class="toctree-l3" href="#setting-the-stage">Setting the stage</a></li>
        
            <li><a class="toctree-l3" href="#basic-plotting">Basic plotting</a></li>
        
            <li><a class="toctree-l3" href="#base-r-data-visualization-options">Base R data visualization options</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="part2.html">II. Basic usage of ggplot2</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="part3.html">III. One level up</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">R from a learners perspective - Data visualization</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
    
      
    
    <li>I. Getting started</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="data-visualization-and-exploration">Data visualization and exploration</h1>
<h2 id="synopsis">Synopsis</h2>
<p>In this part of the workshop you will familiarize yourself with:</p>
<ul>
<li>R's basic plotting capabilities</li>
<li><em>ggplot2</em>, its syntax and fundamentals</li>
<li>as well as some advanced data visualization</li>
</ul>
<p>If you have questions ASK, feel free to drop me an <a href="mailto:carl-eric.wegner@uni-jena.de">e-mail</a> also after the workshop.</p>
<h2 id="setting-the-stage">Setting the stage</h2>
<p>Plotting is a very personal thing (btw color schemes as well), ask three different people and you will get a variety of feedback with respect to plotting and data visualization in general. A lot of people get away with <em>Excel</em>, <em>SigmaPlot</em>, <em>GraphPad</em>, <em>Matplotlib</em> (if you are a Pythonista, which makes you a good person by default) or something else. </p>
<p>R as its parent S is a programming language primarily dedicated to data manipulation (in a good sense) and statistical analysis. Due to its modular architecture and the availabilitry of sophisticated libraries for data processing and plotting it is an excellent choice for any kind of data visualization.</p>
<p>When I got in touch with R the first time, I was googling options how to do a complex multi-panel figure. The original query was "plot facets vector graphics". If you do the exact same query now, you will end up with <em>ggplot2</em> being the second hit. Yep, this is how I "met" R and years later I would still lie if I would say that I'm any sort of R expert. Most of me using R is still centered around the following dogma:</p>
<ol>
<li>Define the problem</li>
<li>Look up necessary R resources</li>
<li>Apply available examples to own data</li>
<li>Be happy after A LOT of try and error.</li>
</ol>
<p>Ok, first things first, fire up RStudio and check whether you have the following packages installed and load them. Throughout the course you can either execute commands from within a script (mark the respective lines of code and hit CTRL+ENTER) or directly in the console.</p>
<pre><code>library(&quot;ggplot2&quot;)
library(&quot;dplyer&quot;)
library(&quot;tidyr&quot;)
library(&quot;ellipse&quot;)
library(&quot;RColorBrewer&quot;)
</code></pre>

<p>Ideally you should see no error message popping up, if you see any then you did not prepare properly for the workshop - shame on you, or rather me, because I did not tell you in time.</p>
<p><img alt="alt text" src="fail.jpg" /></p>
<h2 id="basic-plotting">Basic plotting</h2>
<p>Enough blabla, this session is about data visualization, where are the plots? Here they come. Create a new R script, type the following two lines and execute them:</p>
<pre><code>dotchart(rnorm(250), col = &quot;blue&quot;, main = &quot;Quick ugly example&quot;)
hist(rnorm(250), col = &quot;blue&quot;, main = &quot;Quick ugly example II&quot;)
</code></pre>

<p>Alternatively type them one after another in the console.</p>
<p>Keep an eye on the plot window, what did just happen?</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<ul>
<li>Try to figure out what the individual functions and parameters do.</li>
</ul>
</div>
<p>First take home message of the day - the R help is your friend (a good one).
The general syntax for calling R's help is:</p>
<p><code>?functionXYZ()</code></p>
<p>Let's start exploring R's basic plotting capabilities in a bit more detail, this is a bit of a recap of what you did yesterday. </p>
<pre><code># Let's define two arbitrary vectors
bacteria &lt;- c(10, 30, 60, 5, 90)
archaea &lt;- c(25, 27, 22, 37, 10)

# Plot them both
plot(bacteria, type=&quot;o&quot;, col = &quot;orange&quot;)
lines(archaea, type=&quot;o&quot;, pch=22, lty=2, col = &quot;blue&quot;)

axis(1, at=1:5, lab=(c(&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;)))
</code></pre>

<p>Let's say what we just plotted are relative abundances for archaea and bacteria across different months. But the output looks like garbage, apparently we had at first default x-axis labels, which were overwritten. The result is this "beauty" of a plot.</p>
<p>How to fix that, take a look at the following code:</p>
<pre><code>plot(bacteria, type=&quot;o&quot;, col = &quot;orange&quot;, axes=FALSE, ann = FALSE)
lines(archaea, type=&quot;o&quot;, pch=22, lty=2, col = &quot;blue&quot;)

axis(1, at=1:5, lab=(c(&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;)))
</code></pre>

<p>Does that make it any better? What is now missing?</p>
<div class="admonition exercise">
<p class="admonition-title">Exercise</p>
<ul>
<li>Call the help for axis(), box(), title(), and legend. </li>
<li>Add a y-axis, a box around the plot, titles for the plot as well as the two axes, and a legend. </li>
</ul>
</div>
<p>One possible solution:</p>
<pre><code>plot(bacteria, type=&quot;o&quot;, col = &quot;orange&quot;, axes=FALSE, xlab = &quot;Month&quot;, ylab = &quot;Rel. abundance [%]&quot;, main = &quot;Bac and Arc&quot;)
lines(archaea, type=&quot;o&quot;, pch=22, lty=3, col = &quot;blue&quot;)
axis(1, at=1:5, lab=(c(&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;)))
box()
axis(2, las = 2)
legend(1, max(bacteria), c(&quot;Bacteria&quot;, &quot;Archaea&quot;), cex=0.8, col=c(&quot;orange&quot;, &quot;blue&quot;), 
       pch=c(21,22), lty=c(1,3))
</code></pre>

<p>Alright, so far we played with a dataset that we quickly created, as you already learned before you can easily import datasets like this from any delimited file. Imagine a file like this (e.g. table.tsv):</p>
<table>
<thead>
<tr>
<th>bacteria</th>
<th>archaea</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>25</td>
</tr>
<tr>
<td>30</td>
<td>27</td>
</tr>
<tr>
<td>60</td>
<td>22</td>
</tr>
<tr>
<td>5</td>
<td>37</td>
</tr>
<tr>
<td>90</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>Two columns, tab-delimited, and the columns have names ("bacteria2, "archaea").</p>
<p>We could read this file as outlined below. </p>
<pre><code># Read the table, pay attention to the header and sep arguments
rel_prok &lt;- read.table(&quot;table.tsv&quot;, header=T, sep=&quot;\t&quot;)

# Instead we merge our two vectors because you did a lot of importing yesterday...
rel_prok &lt;- data.frame(bacteria, archaea)
colnames(rel_prok) &lt;- c(bacteria, archaea)

# We define colors to be used with our data series, because why not
plot_colors &lt;- c(&quot;blue&quot;, &quot;orange&quot;)

# We initiate a PNG devide to save the output
png(filename=&quot;output.png&quot;, height=250, width=300, bg=&quot;white&quot;)

# AND NOW?!
# Adapt your code
# and end it with
dev.off()
# to turn off the PNG device
</code></pre>

<div class="admonition exercise">
<p class="admonition-title">Exercise</p>
<ul>
<li>Plot the data as before, and save the output as a .png.</li>
<li>Do you have to adjust the dimensions?</li>
<li>What is the dev.off() function doing?</li>
</ul>
</div>
<h2 id="base-r-data-visualization-options">Base R data visualization options</h2>
<p>So far we basically only did line charts, base R provides us however with a whole range of different visualization options. </p>
<p>Let's take one of our vectors and see how we can create bar charts and how we can visualize both data series by dot charts.</p>
<p>Bar charts:</p>
<pre><code>bacteria &lt;- c(10, 30, 60, 5, 90)

# A simple bar plot
barplot(bacteria, main=&quot;Bacteria relative abundance&quot;, xlab=&quot;Month&quot;,
   ylab=&quot;Rel. abundance [%]&quot;, names.arg=c(&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;))

# Simple, and slightly pimped, pattern fill
barplot(bacteria, main=&quot;Bacteria relative abundance&quot;, xlab=&quot;Month&quot;,  
   ylab=&quot;Rel. abundance [%]&quot;, names.arg=c(&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;), 
   border=&quot;gray&quot;, density=c(10,20,30,40,50))

# Add a box around the plot because we like boxes
box()

# This time with colors
barplot(bacteria, main=&quot;Bacteria relative abundance&quot;, xlab=&quot;Month&quot;,  
        ylab=&quot;Rel. abundance [%]&quot;, names.arg=c(&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;),
        col=rainbow(5))
</code></pre>

<p>And a dot chart:</p>
<pre><code># Plot the dotchart
dotchart(t(rel_prok), color=c(&quot;blue&quot;, &quot;red&quot;), main=&quot;Dotchart Bacteria and Archaea&quot;)
</code></pre>

<p>We finish this first session with a little exercise.</p>
<div class="admonition exercise">
<p class="admonition-title">Exercise</p>
<p>Use the simple dataset to plot a grouped bar chart incl. a legend and a dot chart with months as row names. Export both as .png files. <em>NOT</em> using RStudio's export function.</p>
</div>
<p>For more examples of using the plotting capabilities of base R have a look for instance <a href="https://www.harding.edu/fmccown/r/">here</a>.</p>
<p>Solutions:</p>
<pre><code># Grouped bar chart
barplot(as.matrix(rel_prok), main=&quot;Bac vs Arc&quot;, ylab= &quot;Rel. abundance&quot;,
        beside=TRUE, col=rainbow(5))
box()

# Place the legend at the top-left corner with no frame  
# using rainbow colors
legend(&quot;topleft&quot;, c(&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;), cex=1, 
       bty=&quot;n&quot;, fill=rainbow(5))
</code></pre>

<pre><code># Dot chart with months as labels
row.names(rel_prok) &lt;- c(&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;)
rel_prok
dotchart(t(rel_prok), color=c(&quot;blue&quot;, &quot;red&quot;), main=&quot;Dotchart Bacteria and Archaea&quot;, cex = 1)
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="part2.html" class="btn btn-neutral float-right" title="II. Basic usage of ggplot2">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
        <span style="margin-left: 15px"><a href="part2.html" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>

</body>
</html>

<!--
MkDocs version : 1.0.4
Build Date UTC : 2018-10-09 12:48:28
-->
